function initWebGL(a,j,m,d,n,b){var e=document.getElementById(a);var h=WebGLUtils.setupWebGL(e);if(!h){return null}h.console=("console" in window)?window.console:{log:function(){}};var l=loadShader(h,j);var f=loadShader(h,m);if(!l||!f){return null}h.program=h.createProgram();if(!h.program){return null}h.attachShader(h.program,l);h.attachShader(h.program,f);for(var g=0;g<d.length;++g){h.bindAttribLocation(h.program,g,d[g])}h.linkProgram(h.program);var c=h.getProgramParameter(h.program,h.LINK_STATUS);if(!c){var k=h.getProgramInfoLog(h.program);h.console.log("Error in program linking:"+k);h.deleteProgram(h.program);h.deleteProgram(f);h.deleteProgram(l);return null}h.useProgram(h.program);h.clearColor(n[0],n[1],n[2],n[3]);h.clearDepth(b);h.enable(h.DEPTH_TEST);h.enable(h.BLEND);h.blendFunc(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA);return h}function loadShader(a,f){var c=document.getElementById(f);if(!c){a.console.log("*** Error: shader script '"+f+"' not found");return null}if(c.type=="x-shader/x-vertex"){var g=a.VERTEX_SHADER}else{if(c.type=="x-shader/x-fragment"){var g=a.FRAGMENT_SHADER}else{a.console.log("*** Error: shader script '"+f+"' of undefined type '"+c.type+"'");return null}}var d=a.createShader(g);if(d==null){a.console.log("*** Error: unable to create shader '"+f+"'");return null}a.shaderSource(d,c.text);a.compileShader(d);var e=a.getShaderParameter(d,a.COMPILE_STATUS);if(!e){var b=a.getShaderInfoLog(d);a.console.log("*** Error compiling shader '"+f+"':"+b);a.deleteShader(d);return null}return d}function makeBox(b){var c=new Float32Array([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,1,-1,-1,1,-1,-1,1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,-1,-1,-1,-1,1,-1,1,1,-1]);var e=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1]);var d=new Float32Array([1,1,0,1,0,0,1,0,0,1,0,0,1,0,1,1,1,0,1,1,0,1,0,0,1,1,0,1,0,0,1,0,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1]);var f=new Uint8Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]);var a={};a.normalObject=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a.normalObject);b.bufferData(b.ARRAY_BUFFER,e,b.STATIC_DRAW);a.texCoordObject=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a.texCoordObject);b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW);a.vertexObject=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,a.vertexObject);b.bufferData(b.ARRAY_BUFFER,c,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,null);a.indexObject=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a.indexObject);b.bufferData(b.ELEMENT_ARRAY_BUFFER,f,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,null);a.numIndices=f.length;return a}function makeSphere(w,d,D,t){var E=[];var o=[];var g=[];var a=[];var f=2;var m=0;for(var h=0;h<f;h++){for(var G=0;G<=D;++G){for(var j=0;j<=t;++j){var i=G*Math.PI/D;var c=j*2*Math.PI/t;var B=Math.sin(i);var A=Math.sin(c);var r=Math.cos(i);var b=Math.cos(c);var n=b*B;var l=r;var k=A*B;var q=1-(j/t);var p=G/D;o.push(n);o.push(l);o.push(k);g.push(q);g.push(p);E.push(d*n);E.push(d*l);E.push(d*k+m)}}m-=2}var C=0;for(var h=0;h<f;h++){for(var G=0;G<D;++G){for(var j=0;j<t;++j){var e=(G*(t+1))+j+C;var F=e+t+1;a.push(e);a.push(F);a.push(e+1);a.push(F);a.push(F+1);a.push(e+1)}}C=(D*(t))+t}var s={};s.normalObject=w.createBuffer();w.bindBuffer(w.ARRAY_BUFFER,s.normalObject);w.bufferData(w.ARRAY_BUFFER,new Float32Array(o),w.STATIC_DRAW);s.texCoordObject=w.createBuffer();w.bindBuffer(w.ARRAY_BUFFER,s.texCoordObject);w.bufferData(w.ARRAY_BUFFER,new Float32Array(g),w.STATIC_DRAW);s.vertexObject=w.createBuffer();w.bindBuffer(w.ARRAY_BUFFER,s.vertexObject);w.bufferData(w.ARRAY_BUFFER,new Float32Array(E),w.STATIC_DRAW);s.numIndices=a.length;s.indexObject=w.createBuffer();w.bindBuffer(w.ELEMENT_ARRAY_BUFFER,s.indexObject);w.bufferData(w.ELEMENT_ARRAY_BUFFER,new Uint16Array(a),w.STREAM_DRAW);return s}function loadObj(a,b){var d={loaded:false};d.ctx=a;var c=new XMLHttpRequest();c.obj=d;c.onreadystatechange=function(){processLoadObj(c)};c.open("GET",b,true);c.send(null);return d}function processLoadObj(a){a.obj.ctx.console.log("req="+a);if(a.readyState==4){doLoadObj(a.obj,a.responseText)}}function doLoadObj(n,o){vertexArray=[];normalArray=[];textureArray=[];indexArray=[];var s=[];var v=[];var p=[];var g={};var e=0;var u={};var b=[-1,0];u._unnamed=b;var a=o.split("\n");for(var q in a){var m=a[q].replace(/[ \t]+/g," ").replace(/\s\s*$/,"");if(m[0]=="#"){continue}var h=m.split(" ");if(h[0]=="g"){b=[indexArray.length,0];u[h[1]]=b}else{if(h[0]=="v"){s.push(parseFloat(h[1]));s.push(parseFloat(h[2]));s.push(parseFloat(h[3]))}else{if(h[0]=="vt"){p.push(parseFloat(h[1]));p.push(parseFloat(h[2]))}else{if(h[0]=="vn"){v.push(parseFloat(h[1]));v.push(parseFloat(h[2]));v.push(parseFloat(h[3]))}else{if(h[0]=="f"){if(h.length!=4){n.ctx.console.log("*** Error: face '"+m+"' not handled");continue}for(var r=1;r<4;++r){if(!(h[r] in g)){var t=h[r].split("/");var d,c,w;if(t.length==1){d=parseInt(t[0])-1;c=d;w=d}else{if(t.length=3){d=parseInt(t[0])-1;w=parseInt(t[1])-1;c=parseInt(t[2])-1}else{n.ctx.console.log("*** Error: did not understand face '"+h[r]+"'");return null}}var l=0;var k=0;var j=0;if(d*3+2<s.length){l=s[d*3];k=s[d*3+1];j=s[d*3+2]}vertexArray.push(l);vertexArray.push(k);vertexArray.push(j);l=0;k=0;if(w*2+1<p.length){l=p[w*2];k=p[w*2+1]}textureArray.push(l);textureArray.push(k);l=0;k=0;j=1;if(c*3+2<v.length){l=v[c*3];k=v[c*3+1];j=v[c*3+2]}normalArray.push(l);normalArray.push(k);normalArray.push(j);g[h[r]]=e++}indexArray.push(g[h[r]]);b[1]++}}}}}}}n.normalObject=n.ctx.createBuffer();n.ctx.bindBuffer(n.ctx.ARRAY_BUFFER,n.normalObject);n.ctx.bufferData(n.ctx.ARRAY_BUFFER,new Float32Array(normalArray),n.ctx.STATIC_DRAW);n.texCoordObject=n.ctx.createBuffer();n.ctx.bindBuffer(n.ctx.ARRAY_BUFFER,n.texCoordObject);n.ctx.bufferData(n.ctx.ARRAY_BUFFER,new Float32Array(textureArray),n.ctx.STATIC_DRAW);n.vertexObject=n.ctx.createBuffer();n.ctx.bindBuffer(n.ctx.ARRAY_BUFFER,n.vertexObject);n.ctx.bufferData(n.ctx.ARRAY_BUFFER,new Float32Array(vertexArray),n.ctx.STATIC_DRAW);n.numIndices=indexArray.length;n.indexObject=n.ctx.createBuffer();n.ctx.bindBuffer(n.ctx.ELEMENT_ARRAY_BUFFER,n.indexObject);n.ctx.bufferData(n.ctx.ELEMENT_ARRAY_BUFFER,new Uint16Array(indexArray),n.ctx.STREAM_DRAW);n.groups=u;n.loaded=true}function loadImageTexture(a,b){var c=a.createTexture();c.image=new Image();c.image.onload=function(){doLoadImageTexture(a,c.image,c)};c.image.src=b;return c}function doLoadImageTexture(a,c,b){a.bindTexture(a.TEXTURE_2D,b);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE);a.bindTexture(a.TEXTURE_2D,null)}Framerate=function(b){this.numFramerates=10;this.framerateUpdateInterval=500;this.id=b;this.renderTime=-1;this.framerates=[];self=this;var a=function(){self.updateFramerate()};setInterval(a,this.framerateUpdateInterval)};Framerate.prototype.updateFramerate=function(){var b=0;for(var a=0;a<this.framerates.length;++a){b+=this.framerates[a]}var c=b/this.framerates.length;c=Math.round(c);document.getElementById(this.id).innerHTML="Framerate:"+c+"fps"};Framerate.prototype.snapshot=function(){if(this.renderTime<0){this.renderTime=new Date().getTime()}else{var c=new Date().getTime();var a=c-this.renderTime;var b=1000/a;this.framerates.push(b);while(this.framerates.length>this.numFramerates){this.framerates.shift()}this.renderTime=c}};