J3DIHasCSSMatrix=false;J3DIHasCSSMatrixCopy=false;J3DIMatrix4=function(a){if(J3DIHasCSSMatrix){this.$matrix=new WebKitCSSMatrix}else{this.$matrix=new Object}if(typeof a=="object"){if("length" in a&&a.length>=16){this.load(a);return}else{if(a instanceof J3DIMatrix4){this.load(a);return}}}this.makeIdentity()};J3DIMatrix4.prototype.load=function(){if(arguments.length==1&&typeof arguments[0]=="object"){var a;if(arguments[0] instanceof J3DIMatrix4){a=arguments[0].$matrix;this.$matrix.m11=a.m11;this.$matrix.m12=a.m12;this.$matrix.m13=a.m13;this.$matrix.m14=a.m14;this.$matrix.m21=a.m21;this.$matrix.m22=a.m22;this.$matrix.m23=a.m23;this.$matrix.m24=a.m24;this.$matrix.m31=a.m31;this.$matrix.m32=a.m32;this.$matrix.m33=a.m33;this.$matrix.m34=a.m34;this.$matrix.m41=a.m41;this.$matrix.m42=a.m42;this.$matrix.m43=a.m43;this.$matrix.m44=a.m44;return}else{a=arguments[0]}if("length" in a&&a.length>=16){this.$matrix.m11=a[0];this.$matrix.m12=a[1];this.$matrix.m13=a[2];this.$matrix.m14=a[3];this.$matrix.m21=a[4];this.$matrix.m22=a[5];this.$matrix.m23=a[6];this.$matrix.m24=a[7];this.$matrix.m31=a[8];this.$matrix.m32=a[9];this.$matrix.m33=a[10];this.$matrix.m34=a[11];this.$matrix.m41=a[12];this.$matrix.m42=a[13];this.$matrix.m43=a[14];this.$matrix.m44=a[15];return}}this.makeIdentity()};J3DIMatrix4.prototype.getAsArray=function(){return[this.$matrix.m11,this.$matrix.m12,this.$matrix.m13,this.$matrix.m14,this.$matrix.m21,this.$matrix.m22,this.$matrix.m23,this.$matrix.m24,this.$matrix.m31,this.$matrix.m32,this.$matrix.m33,this.$matrix.m34,this.$matrix.m41,this.$matrix.m42,this.$matrix.m43,this.$matrix.m44]};J3DIMatrix4.prototype.getAsFloat32Array=function(){if(J3DIHasCSSMatrixCopy){var a=new Float32Array(16);this.$matrix.copy(a);return a}return new Float32Array(this.getAsArray())};J3DIMatrix4.prototype.setUniform=function(a,c,b){if(J3DIMatrix4.setUniformArray==undefined){J3DIMatrix4.setUniformWebGLArray=new Float32Array(16);J3DIMatrix4.setUniformArray=new Array(16)}if(J3DIHasCSSMatrixCopy){this.$matrix.copy(J3DIMatrix4.setUniformWebGLArray)}else{J3DIMatrix4.setUniformArray[0]=this.$matrix.m11;J3DIMatrix4.setUniformArray[1]=this.$matrix.m12;J3DIMatrix4.setUniformArray[2]=this.$matrix.m13;J3DIMatrix4.setUniformArray[3]=this.$matrix.m14;J3DIMatrix4.setUniformArray[4]=this.$matrix.m21;J3DIMatrix4.setUniformArray[5]=this.$matrix.m22;J3DIMatrix4.setUniformArray[6]=this.$matrix.m23;J3DIMatrix4.setUniformArray[7]=this.$matrix.m24;J3DIMatrix4.setUniformArray[8]=this.$matrix.m31;J3DIMatrix4.setUniformArray[9]=this.$matrix.m32;J3DIMatrix4.setUniformArray[10]=this.$matrix.m33;J3DIMatrix4.setUniformArray[11]=this.$matrix.m34;J3DIMatrix4.setUniformArray[12]=this.$matrix.m41;J3DIMatrix4.setUniformArray[13]=this.$matrix.m42;J3DIMatrix4.setUniformArray[14]=this.$matrix.m43;J3DIMatrix4.setUniformArray[15]=this.$matrix.m44;J3DIMatrix4.setUniformWebGLArray.set(J3DIMatrix4.setUniformArray)}a.uniformMatrix4fv(c,b,J3DIMatrix4.setUniformWebGLArray)};J3DIMatrix4.prototype.makeIdentity=function(){this.$matrix.m11=1;this.$matrix.m12=0;this.$matrix.m13=0;this.$matrix.m14=0;this.$matrix.m21=0;this.$matrix.m22=1;this.$matrix.m23=0;this.$matrix.m24=0;this.$matrix.m31=0;this.$matrix.m32=0;this.$matrix.m33=1;this.$matrix.m34=0;this.$matrix.m41=0;this.$matrix.m42=0;this.$matrix.m43=0;this.$matrix.m44=1};J3DIMatrix4.prototype.transpose=function(){var a=this.$matrix.m12;this.$matrix.m12=this.$matrix.m21;this.$matrix.m21=a;a=this.$matrix.m13;this.$matrix.m13=this.$matrix.m31;this.$matrix.m31=a;a=this.$matrix.m14;this.$matrix.m14=this.$matrix.m41;this.$matrix.m41=a;a=this.$matrix.m23;this.$matrix.m23=this.$matrix.m32;this.$matrix.m32=a;a=this.$matrix.m24;this.$matrix.m24=this.$matrix.m42;this.$matrix.m42=a;a=this.$matrix.m34;this.$matrix.m34=this.$matrix.m43;this.$matrix.m43=a};J3DIMatrix4.prototype.invert=function(){if(J3DIHasCSSMatrix){this.$matrix=this.$matrix.inverse();return}var a=this._determinant4x4();if(Math.abs(a)<1e-8){return null}this._makeAdjoint();this.$matrix.m11/=a;this.$matrix.m12/=a;this.$matrix.m13/=a;this.$matrix.m14/=a;this.$matrix.m21/=a;this.$matrix.m22/=a;this.$matrix.m23/=a;this.$matrix.m24/=a;this.$matrix.m31/=a;this.$matrix.m32/=a;this.$matrix.m33/=a;this.$matrix.m34/=a;this.$matrix.m41/=a;this.$matrix.m42/=a;this.$matrix.m43/=a;this.$matrix.m44/=a};J3DIMatrix4.prototype.translate=function(a,e,d){if(typeof a=="object"&&"length" in a){var c=a;a=c[0];e=c[1];d=c[2]}else{if(a==undefined){a=0}if(e==undefined){e=0}if(d==undefined){d=0}}if(J3DIHasCSSMatrix){this.$matrix=this.$matrix.translate(a,e,d);return}var b=new J3DIMatrix4();b.$matrix.m41=a;b.$matrix.m42=e;b.$matrix.m43=d;this.multiply(b)};J3DIMatrix4.prototype.scale=function(a,e,d){if(typeof a=="object"&&"length" in a){var c=a;a=c[0];e=c[1];d=c[2]}else{if(a==undefined){a=1}if(d==undefined){if(e==undefined){e=a;d=a}else{d=1}}else{if(e==undefined){e=a}}}if(J3DIHasCSSMatrix){this.$matrix=this.$matrix.scale(a,e,d);return}var b=new J3DIMatrix4();b.$matrix.m11=a;b.$matrix.m22=e;b.$matrix.m33=d;this.multiply(b)};J3DIMatrix4.prototype.rotate=function(b,l,h,f){if(typeof l=="object"&&"length" in l){var n=l;l=n[0];h=n[1];f=n[2]}else{if(arguments.length==1){l=0;h=0;f=1}else{if(arguments.length==3){this.rotate(b,1,0,0);this.rotate(l,0,1,0);this.rotate(h,0,0,1);return}}}if(J3DIHasCSSMatrix){this.$matrix=this.$matrix.rotateAxisAngle(l,h,f,b);return}b=b/180*Math.PI;b/=2;var j=Math.sin(b);var d=Math.cos(b);var k=j*j;var e=Math.sqrt(l*l+h*h+f*f);if(e==0){l=0;h=0;f=1}else{if(e!=1){l/=e;h/=e;f/=e}}var m=new J3DIMatrix4();if(l==1&&h==0&&f==0){m.$matrix.m11=1;m.$matrix.m12=0;m.$matrix.m13=0;m.$matrix.m21=0;m.$matrix.m22=1-2*k;m.$matrix.m23=2*j*d;m.$matrix.m31=0;m.$matrix.m32=-2*j*d;m.$matrix.m33=1-2*k;m.$matrix.m14=m.$matrix.m24=m.$matrix.m34=0;m.$matrix.m41=m.$matrix.m42=m.$matrix.m43=0;m.$matrix.m44=1}else{if(l==0&&h==1&&f==0){m.$matrix.m11=1-2*k;m.$matrix.m12=0;m.$matrix.m13=-2*j*d;m.$matrix.m21=0;m.$matrix.m22=1;m.$matrix.m23=0;m.$matrix.m31=2*j*d;m.$matrix.m32=0;m.$matrix.m33=1-2*k;m.$matrix.m14=m.$matrix.m24=m.$matrix.m34=0;m.$matrix.m41=m.$matrix.m42=m.$matrix.m43=0;m.$matrix.m44=1}else{if(l==0&&h==0&&f==1){m.$matrix.m11=1-2*k;m.$matrix.m12=2*j*d;m.$matrix.m13=0;m.$matrix.m21=-2*j*d;m.$matrix.m22=1-2*k;m.$matrix.m23=0;m.$matrix.m31=0;m.$matrix.m32=0;m.$matrix.m33=1;m.$matrix.m14=m.$matrix.m24=m.$matrix.m34=0;m.$matrix.m41=m.$matrix.m42=m.$matrix.m43=0;m.$matrix.m44=1}else{var a=l*l;var g=h*h;var c=f*f;m.$matrix.m11=1-2*(g+c)*k;m.$matrix.m12=2*(l*h*k+f*j*d);m.$matrix.m13=2*(l*f*k-h*j*d);m.$matrix.m21=2*(h*l*k-f*j*d);m.$matrix.m22=1-2*(c+a)*k;m.$matrix.m23=2*(h*f*k+l*j*d);m.$matrix.m31=2*(f*l*k+h*j*d);m.$matrix.m32=2*(f*h*k-l*j*d);m.$matrix.m33=1-2*(a+g)*k;m.$matrix.m14=m.$matrix.m24=m.$matrix.m34=0;m.$matrix.m41=m.$matrix.m42=m.$matrix.m43=0;m.$matrix.m44=1}}}this.multiply(m)};J3DIMatrix4.prototype.multiply=function(r){if(J3DIHasCSSMatrix){this.$matrix=this.$matrix.multiply(r.$matrix);return}var m=(r.$matrix.m11*this.$matrix.m11+r.$matrix.m12*this.$matrix.m21+r.$matrix.m13*this.$matrix.m31+r.$matrix.m14*this.$matrix.m41);var l=(r.$matrix.m11*this.$matrix.m12+r.$matrix.m12*this.$matrix.m22+r.$matrix.m13*this.$matrix.m32+r.$matrix.m14*this.$matrix.m42);var j=(r.$matrix.m11*this.$matrix.m13+r.$matrix.m12*this.$matrix.m23+r.$matrix.m13*this.$matrix.m33+r.$matrix.m14*this.$matrix.m43);var g=(r.$matrix.m11*this.$matrix.m14+r.$matrix.m12*this.$matrix.m24+r.$matrix.m13*this.$matrix.m34+r.$matrix.m14*this.$matrix.m44);var d=(r.$matrix.m21*this.$matrix.m11+r.$matrix.m22*this.$matrix.m21+r.$matrix.m23*this.$matrix.m31+r.$matrix.m24*this.$matrix.m41);var c=(r.$matrix.m21*this.$matrix.m12+r.$matrix.m22*this.$matrix.m22+r.$matrix.m23*this.$matrix.m32+r.$matrix.m24*this.$matrix.m42);var b=(r.$matrix.m21*this.$matrix.m13+r.$matrix.m22*this.$matrix.m23+r.$matrix.m23*this.$matrix.m33+r.$matrix.m24*this.$matrix.m43);var a=(r.$matrix.m21*this.$matrix.m14+r.$matrix.m22*this.$matrix.m24+r.$matrix.m23*this.$matrix.m34+r.$matrix.m24*this.$matrix.m44);var q=(r.$matrix.m31*this.$matrix.m11+r.$matrix.m32*this.$matrix.m21+r.$matrix.m33*this.$matrix.m31+r.$matrix.m34*this.$matrix.m41);var p=(r.$matrix.m31*this.$matrix.m12+r.$matrix.m32*this.$matrix.m22+r.$matrix.m33*this.$matrix.m32+r.$matrix.m34*this.$matrix.m42);var o=(r.$matrix.m31*this.$matrix.m13+r.$matrix.m32*this.$matrix.m23+r.$matrix.m33*this.$matrix.m33+r.$matrix.m34*this.$matrix.m43);var n=(r.$matrix.m31*this.$matrix.m14+r.$matrix.m32*this.$matrix.m24+r.$matrix.m33*this.$matrix.m34+r.$matrix.m34*this.$matrix.m44);var k=(r.$matrix.m41*this.$matrix.m11+r.$matrix.m42*this.$matrix.m21+r.$matrix.m43*this.$matrix.m31+r.$matrix.m44*this.$matrix.m41);var h=(r.$matrix.m41*this.$matrix.m12+r.$matrix.m42*this.$matrix.m22+r.$matrix.m43*this.$matrix.m32+r.$matrix.m44*this.$matrix.m42);var f=(r.$matrix.m41*this.$matrix.m13+r.$matrix.m42*this.$matrix.m23+r.$matrix.m43*this.$matrix.m33+r.$matrix.m44*this.$matrix.m43);var e=(r.$matrix.m41*this.$matrix.m14+r.$matrix.m42*this.$matrix.m24+r.$matrix.m43*this.$matrix.m34+r.$matrix.m44*this.$matrix.m44);this.$matrix.m11=m;this.$matrix.m12=l;this.$matrix.m13=j;this.$matrix.m14=g;this.$matrix.m21=d;this.$matrix.m22=c;this.$matrix.m23=b;this.$matrix.m24=a;this.$matrix.m31=q;this.$matrix.m32=p;this.$matrix.m33=o;this.$matrix.m34=n;this.$matrix.m41=k;this.$matrix.m42=h;this.$matrix.m43=f;this.$matrix.m44=e};J3DIMatrix4.prototype.divide=function(a){this.$matrix.m11/=a;this.$matrix.m12/=a;this.$matrix.m13/=a;this.$matrix.m14/=a;this.$matrix.m21/=a;this.$matrix.m22/=a;this.$matrix.m23/=a;this.$matrix.m24/=a;this.$matrix.m31/=a;this.$matrix.m32/=a;this.$matrix.m33/=a;this.$matrix.m34/=a;this.$matrix.m41/=a;this.$matrix.m42/=a;this.$matrix.m43/=a;this.$matrix.m44/=a};J3DIMatrix4.prototype.ortho=function(b,k,a,h,g,f){var e=(b+k)/(b-k);var d=(h+a)/(h-a);var c=(f+g)/(f-g);var j=new J3DIMatrix4();j.$matrix.m11=2/(b-k);j.$matrix.m12=0;j.$matrix.m13=0;j.$matrix.m14=0;j.$matrix.m21=0;j.$matrix.m22=2/(h-a);j.$matrix.m23=0;j.$matrix.m24=0;j.$matrix.m31=0;j.$matrix.m32=0;j.$matrix.m33=-2/(f-g);j.$matrix.m34=0;j.$matrix.m41=e;j.$matrix.m42=d;j.$matrix.m43=c;j.$matrix.m44=1;this.multiply(j)};J3DIMatrix4.prototype.frustum=function(f,l,b,j,h,g){var k=new J3DIMatrix4();var e=(l+f)/(l-f);var d=(j+b)/(j-b);var c=-(g+h)/(g-h);var a=-(2*g*h)/(g-h);k.$matrix.m11=(2*h)/(l-f);k.$matrix.m12=0;k.$matrix.m13=0;k.$matrix.m14=0;k.$matrix.m21=0;k.$matrix.m22=2*h/(j-b);k.$matrix.m23=0;k.$matrix.m24=0;k.$matrix.m31=e;k.$matrix.m32=d;k.$matrix.m33=c;k.$matrix.m34=-1;k.$matrix.m41=0;k.$matrix.m42=0;k.$matrix.m43=a;k.$matrix.m44=0;this.multiply(k)};J3DIMatrix4.prototype.perspective=function(c,b,h,e){var g=Math.tan(c*Math.PI/360)*h;var a=-g;var f=b*a;var d=b*g;this.frustum(f,d,a,g,h,e)};J3DIMatrix4.prototype.lookat=function(p,o,n,l,k,j,d,c,b){if(typeof n=="object"&&"length" in n){var e=n;d=e[0];c=e[1];b=e[2];e=o;l=e[0];k=e[1];j=e[2];e=p;p=e[0];o=e[1];n=e[2]}var m=new J3DIMatrix4();var s=p-l;var r=o-k;var q=n-j;var a=Math.sqrt(s*s+r*r+q*q);if(a){s/=a;r/=a;q/=a}var h=d;var g=c;var f=b;xx=g*q-f*r;xy=-h*q+f*s;xz=h*r-g*s;h=r*xz-q*xy;g=-s*xz+q*xx;h=s*xy-r*xx;a=Math.sqrt(xx*xx+xy*xy+xz*xz);if(a){xx/=a;xy/=a;xz/=a}a=Math.sqrt(h*h+g*g+f*f);if(a){h/=a;g/=a;f/=a}if(0){m.$matrix.m11=xx;m.$matrix.m12=xy;m.$matrix.m13=xz;m.$matrix.m14=0;m.$matrix.m21=h;m.$matrix.m22=g;m.$matrix.m23=f;m.$matrix.m24=0;m.$matrix.m31=s;m.$matrix.m32=r;m.$matrix.m33=q;m.$matrix.m34=0;m.$matrix.m41=0;m.$matrix.m42=0;m.$matrix.m43=0;m.$matrix.m44=1;m.translate(-p,-o,-n)}else{m.$matrix.m11=xx;m.$matrix.m12=h;m.$matrix.m13=s;m.$matrix.m14=0;m.$matrix.m21=xy;m.$matrix.m22=g;m.$matrix.m23=r;m.$matrix.m24=0;m.$matrix.m31=xz;m.$matrix.m32=f;m.$matrix.m33=q;m.$matrix.m34=0;m.$matrix.m41=0;m.$matrix.m42=0;m.$matrix.m43=0;m.$matrix.m44=1;m.translate(-p,-o,-n)}this.multiply(m)};J3DIMatrix4.prototype.decompose=function(t,b,e,p,a){if(this.$matrix.m44==0){return false}var d,o,u,c,f;var d=(t==undefined||!("length" in t))?new J3DIVector3:t;var o=(b==undefined||!("length" in b))?new J3DIVector3:b;var u=(e==undefined||!("length" in e))?new J3DIVector3:e;var c=(p==undefined||!("length" in p))?new J3DIVector3:p;var f=(a==undefined||!("length" in a))?new Array(4):a;var m=new J3DIMatrix4(this);m.divide(m.$matrix.m44);var k=new J3DIMatrix4(m);k.$matrix.m14=0;k.$matrix.m24=0;k.$matrix.m34=0;k.$matrix.m44=1;if(k._determinant4x4()==0){return false}if(m.$matrix.m14!=0||m.$matrix.m24!=0||m.$matrix.m34!=0){var j=[m.$matrix.m14,m.$matrix.m24,m.$matrix.m34,m.$matrix.m44];var n=new J3DIMatrix4(k);n.invert();var h=new J3DIMatrix4(n);h.transpose();h.multVecMatrix(f,j);m.$matrix.m14=m.$matrix.m24=m.$matrix.m34=0;m.$matrix.m44=1}else{f[0]=f[1]=f[2]=0;f[3]=1}d[0]=m.$matrix.m41;m.$matrix.m41=0;d[1]=m.$matrix.m42;m.$matrix.m42=0;d[2]=m.$matrix.m43;m.$matrix.m43=0;var s=new J3DIVector3(m.$matrix.m11,m.$matrix.m12,m.$matrix.m13);var r=new J3DIVector3(m.$matrix.m21,m.$matrix.m22,m.$matrix.m23);var q=new J3DIVector3(m.$matrix.m31,m.$matrix.m32,m.$matrix.m33);u[0]=s.vectorLength();s.divide(u[0]);c[0]=s.dot(r);r.combine(s,1,-c[0]);u[1]=r.vectorLength();r.divide(u[1]);c[0]/=u[1];c[1]=r.dot(q);q.combine(s,1,-c[1]);c[2]=r.dot(q);q.combine(r,1,-c[2]);u[2]=q.vectorLength();q.divide(u[2]);c[1]/=u[2];c[2]/=u[2];var l=new J3DIVector3(r);l.cross(q);if(s.dot(l)<0){for(i=0;i<3;i++){u[i]*=-1;row[0][i]*=-1;row[1][i]*=-1;row[2][i]*=-1}}o[1]=Math.asin(-s[2]);if(Math.cos(o[1])!=0){o[0]=Math.atan2(r[2],q[2]);o[2]=Math.atan2(s[1],s[0])}else{o[0]=Math.atan2(-q[0],r[1]);o[2]=0}var g=180/Math.PI;o[0]*=g;o[1]*=g;o[2]*=g;return true};J3DIMatrix4.prototype._determinant2x2=function(f,e,h,g){return f*g-e*h};J3DIMatrix4.prototype._determinant3x3=function(c,b,a,j,h,g,f,e,d){return c*this._determinant2x2(h,g,e,d)-j*this._determinant2x2(b,a,e,d)+f*this._determinant2x2(b,a,h,g)};J3DIMatrix4.prototype._determinant4x4=function(){var e=this.$matrix.m11;var n=this.$matrix.m12;var j=this.$matrix.m13;var c=this.$matrix.m14;var d=this.$matrix.m21;var m=this.$matrix.m22;var h=this.$matrix.m23;var b=this.$matrix.m24;var a=this.$matrix.m31;var l=this.$matrix.m32;var g=this.$matrix.m33;var q=this.$matrix.m34;var p=this.$matrix.m41;var k=this.$matrix.m42;var f=this.$matrix.m43;var o=this.$matrix.m44;return e*this._determinant3x3(m,l,k,h,g,f,b,q,o)-n*this._determinant3x3(d,a,p,h,g,f,b,q,o)+j*this._determinant3x3(d,a,p,m,l,k,b,q,o)-c*this._determinant3x3(d,a,p,m,l,k,h,g,f)};J3DIMatrix4.prototype._makeAdjoint=function(){var e=this.$matrix.m11;var n=this.$matrix.m12;var j=this.$matrix.m13;var c=this.$matrix.m14;var d=this.$matrix.m21;var m=this.$matrix.m22;var h=this.$matrix.m23;var b=this.$matrix.m24;var a=this.$matrix.m31;var l=this.$matrix.m32;var g=this.$matrix.m33;var q=this.$matrix.m34;var p=this.$matrix.m41;var k=this.$matrix.m42;var f=this.$matrix.m43;var o=this.$matrix.m44;this.$matrix.m11=this._determinant3x3(m,l,k,h,g,f,b,q,o);this.$matrix.m21=-this._determinant3x3(d,a,p,h,g,f,b,q,o);this.$matrix.m31=this._determinant3x3(d,a,p,m,l,k,b,q,o);this.$matrix.m41=-this._determinant3x3(d,a,p,m,l,k,h,g,f);this.$matrix.m12=-this._determinant3x3(n,l,k,j,g,f,c,q,o);this.$matrix.m22=this._determinant3x3(e,a,p,j,g,f,c,q,o);this.$matrix.m32=-this._determinant3x3(e,a,p,n,l,k,c,q,o);this.$matrix.m42=this._determinant3x3(e,a,p,n,l,k,j,g,f);this.$matrix.m13=this._determinant3x3(n,m,k,j,h,f,c,b,o);this.$matrix.m23=-this._determinant3x3(e,d,p,j,h,f,c,b,o);this.$matrix.m33=this._determinant3x3(e,d,p,n,m,k,c,b,o);this.$matrix.m43=-this._determinant3x3(e,d,p,n,m,k,j,h,f);this.$matrix.m14=-this._determinant3x3(n,m,l,j,h,g,c,b,q);this.$matrix.m24=this._determinant3x3(e,d,a,j,h,g,c,b,q);this.$matrix.m34=-this._determinant3x3(e,d,a,n,m,l,c,b,q);this.$matrix.m44=this._determinant3x3(e,d,a,n,m,l,j,h,g)};J3DIVector3=function(a,c,b){this.load(a,c,b)};J3DIVector3.prototype.load=function(a,c,b){if(typeof a=="object"&&"length" in a){this[0]=a[0];this[1]=a[1];this[2]=a[2]}else{if(typeof a=="number"){this[0]=a;this[1]=c;this[2]=b}else{this[0]=0;this[1]=0;this[2]=0}}};J3DIVector3.prototype.getAsArray=function(){return[this[0],this[1],this[2]]};J3DIVector3.prototype.getAsFloat32Array=function(){return new Float32Array(this.getAsArray())};J3DIVector3.prototype.vectorLength=function(){return Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2])};J3DIVector3.prototype.divide=function(a){this[0]/=a;this[1]/=a;this[2]/=a};J3DIVector3.prototype.cross=function(a){this[0]=this[1]*a[2]-this[2]*a[1];this[1]=-this[0]*a[2]+this[2]*a[0];this[2]=this[0]*a[1]-this[1]*a[0]};J3DIVector3.prototype.dot=function(a){return this[0]*a[0]+this[1]*a[1]+this[2]*a[2]};J3DIVector3.prototype.combine=function(a,c,b){this[0]=(c*this[0])+(b*a[0]);this[1]=(c*this[1])+(b*a[1]);this[2]=(c*this[2])+(b*a[2])};J3DIVector3.prototype.multVecMatrix=function(c){var a=this[0];var e=this[1];var d=this[2];this[0]=c.$matrix.m41+a*c.$matrix.m11+e*c.$matrix.m21+d*c.$matrix.m31;this[1]=c.$matrix.m42+a*c.$matrix.m12+e*c.$matrix.m22+d*c.$matrix.m32;this[2]=c.$matrix.m43+a*c.$matrix.m13+e*c.$matrix.m23+d*c.$matrix.m33;var b=c.$matrix.m44+a*c.$matrix.m14+e*c.$matrix.m24+d*c.$matrix.m34;if(b!=1&&b!=0){this[0]/=b;this[1]/=b;this[2]/=b}};J3DIVector3.prototype.toString=function(){return"["+this[0]+","+this[1]+","+this[2]+"]"};